# Обзор компонента

[TOC]

Системный компонент `bitrix:main.ui.filter` обеспечивает отображение фильтра на странице и отвечает за визуальную часть блока "фильтр + поиск".
Для более углубленного изучения, его можно найти в директории `bitrix/components/bitrix/main.ui.filter/` вашего проекта.

Немного терминологии:
- Фильтром в контексте этой статьи называется весь компонент обеспечивающий работу фильтрации.
- Поле - это выведенные в компоненте фильтра управляющие элементы, обеспечивающие фильтрации по какому-либо признаку
- Пресет - именованная группировка полей фильтра, которая может содержать предустановленные значения
- Конфигурация поля - мета-информация о поле, описывает тип, обязательность, множественность и т.п.

## Параметры компонента

`FILTER_ID` (string) - уникальный идентификатор фильтра, используемый для отделения его от других фильтров в продукте. Единственный обязательный параметр компонента.

`FILTER` (array) - набор конфигураций полей фильтра.

`FILTER_ROWS` (array) - опциональный параметр показывающий какие поля из `FILTER` сейчас находятся на форме. Если не передан - будет вычислен из полей `FILTER` и пресета пользователя. По сути ассоциативный массив `код поля => bool-значение, true если отображается`

`FILTER_PRESETS` (array) - набор пресетов, отображающихся у пользователей как системные (их нельзя удалить).
В фильтре всегда есть пресет с кодом `default_filter`, добавлять его самому не нужно, но и переопределять его не имеет смысла - он будет добавален автоматически компонентом.

`COMMON_PRESETS_ID` (string) - пресет из списка `FILTER_PRESETS`, являющийся основным (т.е. по-умолчанию) при открытии страницы.

`CONFIG` (array) - массив дополнительной приоритетной информации относительно конфигурации пользователя. Подробнее он разобран в "Поведение ключа `CONFIG`".

`VALUE_REQUIRED` (bool) - нужно ли контролировать в фильтре обязательные параметры. В случае если параметр `true`, будет выполнен поиск обязательных полей и принудительный вывод на выбранный экран. Обязательные поля нельзя будет удалить из отображения фильтра.

`THEME` - идентификатор темы применяемой для фильтра. Подробнее в главе `Темы`


### Изменение фильтра через `apply_filter` и POST-запрос

Существует возможность задавать заранее выбранные значения через query string (GET) параметры страницы, при условии `POST` запроса к странице.
При открытии страницы, проверяется наличие POST-параметра `apply_filter` и если там находится `Y`, происходит замена пользовательского фильтра переданного в GET-параметре `filter_id` на значения переданные при отправке запроса (читается как GET, так и POST параметры - порядок - сначала GET, потом POST накладываются друг на друга заменяя).


### Поведение ключа `CONFIG`




## Темы для фильтра

Компонент поддерживает возможность применения тем. Тема - это визуальный стил фильтра, который применяется поверх стандартного отображения.
Набор тем ограничен стандартными темами.

За работу тем отвечает класс `Bitrix\Main\UI\Filter\Theme`, который имеет константы тем и единственный метод `getList()` который возвращает список всех доступных тем (констант класса).

Доступные темы:

- По-умолчанию (`Theme::DEFAULT_FILTER`)
- Обрамленная (`Theme::BORDER`) - отличие от по-умолчанию в блоке фильтрации добавлена линии сверху и снизу от фильтра
- Округленная (`Theme::ROUNDED`) - левый и правый клая в блоке фильтрации сильно скруглены
- Легкая (`Theme::LIGHT`) - у фильтра белый фон заменен на полупрозрачный серый
- Приглушенная (`Theme::MUTED`) - текст в фильтре не броский, становится более контрастным при наведении 